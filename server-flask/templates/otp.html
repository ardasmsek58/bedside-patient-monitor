<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ä°ki AÅŸamalÄ± DoÄŸrulama - VitaScope</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/otp.css') }}">
</head>
<body>
    <div class="bg-animation">
        <div class="particle" style="left: 10%; top: 20%; width: 4px; height: 4px; animation-delay: 0s;"></div>
        <div class="particle" style="left: 70%; top: 80%; width: 6px; height: 6px; animation-delay: 1s;"></div>
        <div class="particle" style="left: 40%; top: 40%; width: 3px; height: 3px; animation-delay: 2s;"></div>
        <div class="particle" style="left: 90%; top: 60%; width: 5px; height: 5px; animation-delay: 3s;"></div>
        <div class="particle" style="left: 20%; top: 70%; width: 4px; height: 4px; animation-delay: 4s;"></div>
        <div class="particle" style="left: 60%; top: 20%; width: 3px; height: 3px; animation-delay: 5s;"></div>
    </div>

    <div class="otp-container">
        <div class="otp-box">
            <div class="email-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                    <polyline points="22,6 12,13 2,6"/>
                </svg>
            </div>

            <div class="otp-title">
                <h2>ðŸ“§ E-posta DoÄŸrulamasÄ±</h2>
            </div>

            <div class="otp-description">
                <p>DoÄŸrulama kodu 
                    {% if user_email %}
                        <span class="email-address">{{ user_email }}</span>
                    {% else %}
                        <span class="email-address">e-posta adresinize</span>
                    {% endif %}
                    gÃ¶nderildi.</p>
                <p>LÃ¼tfen 6 haneli kodu aÅŸaÄŸÄ±ya girin:</p>
            </div>

            <!-- Flask flash mesajlarÄ± -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="flash {{ category }}">{{ message }}</div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <!-- OTP Form -->
            <form method="POST" action="{{ url_for('verify_otp') }}">
                {{ form.hidden_tag() }}
                
                <div class="form-group">
                    {{ form.otp_code.label(class="form-label") }}
                    {{ form.otp_code(class="form-control", placeholder="000000", maxlength="6", autocomplete="off") }}
                    {% if form.otp_code.errors %}
                        <div class="flash danger" style="margin-top: 10px;">
                            {{ form.otp_code.errors[0] }}
                        </div>
                    {% endif %}
                </div>

                <button type="submit" class="verify-btn">
                    {{ form.submit.label.text }}
                </button>
            </form>

            <!-- Yeniden GÃ¶nder BÃ¶lÃ¼mÃ¼ -->
            <div class="resend-section">
                <p>Kod gelmedi mi?</p>
                <a href="#" class="resend-link" id="resendLink" onclick="resendOTP()">
                    Yeniden GÃ¶nder
                </a>
                <div class="timer" id="timer" style="display: none;">
                    Yeniden gÃ¶nder: <span id="countdown">60</span> saniye
                </div>
            </div>

            <!-- Geri DÃ¶n Linki -->
            <div class="back-link">
                <a href="{{ url_for('login') }}">&larr; GiriÅŸ sayfasÄ±na dÃ¶n</a>
            </div>
        </div>
    </div>

    <script defer src="{{ url_for('static', filename='js/otp.js') }}"></script>
</body>
</html>